<%- include("./partials/head", {pageTitle: "Formulario Producto", stylesheet: "productForm.css"}) %>


<%- include("partials/header",{logueado: logueado})%>
<script src="/js/productForm.js" defer></script>
    
    <div class="contenedorGeneral">
<div class="imagen1">
    <img src="/images/perchero1.jpg" alt="imagen1">
</div>
    <form action="/products" method="post" enctype="multipart/form-data">
        <div class="createProduct">
        <div class="titleForm">
            <div class="imageForm">
                
                <label>PUBLICA TU PRODUCTO</label>    
            </div>
        </div>
        <div class="name">
            <label for="name">Nombre Del Producto</label>
            <input type="text" name="name" id="name" placeholder="Remera,pantalon..." required>
        </div>
        <div class="image">
            <label for="image">Imagen del Producto</label>
            <br>
            <button type="button" class="iconImageInput" id="imagen"> <i class="fa-solid fa-camera"></i></button>
            <input type="file" name="image" id="image" accept="image/*" multiple required>
            <div id="errorImagen" type='error'></div>
            
        </div>
        <div class="price">
            <p class="price">Precio</p>
            <input type="number" name="price" id="price" placeholder="$" required>
        </div>
        <br>

        <div class="brand">
        <input type="text" name="brand" id="brand" placeholder="Marca del producto" required> </div>

        <div class="category">
            <p type="text" name="category" id="category" placeholder="Categoria del producto">Categoria</p>
            <select  name = "category">
                <% for (let i = 0; i < categories.length; i++) {%>
                    <option value="<%= categories[i].id %>">

                        <%= categories[i].genre %> 

                    </option>
                <% } %> 
          </select>
        </div>
        <div class="subcategory">
            <p type="text" name="subcategory" id="subcategory" placeholder="Subcategoria del producto">Subcategoria</p>
            <select  name = "subCategory">
                <% for (let i = 0; i < subCategories.length; i++) {%>
                    <option value="<%= subCategories[i].id %>">

                        <%= subCategories[i].name %> 

                    </option>
                <% } %> 
          </select>
        </div>
        
        <div class="condition">
            <input type="radio" name="condition" value="nuevo" required>NUEVO
            <input type="radio" name="condition" value="usado" required>USADO
          </div>
          
        <div class="size" required>
            <% for (let i = 0; i < sizes.length; i++) {%>
                <input type="checkbox" name="size" value="<%= sizes[i].id%>" > <%= sizes[i].name%>
            <% } %> 
            
        </div>
        <div class="color">
            <select  name = "color">
                <% for (let i = 0; i < colors.length; i++) {%>
                    <option value="<%= colors[i].id %>">

                        <%= colors[i].name %> 

                    </option>
                <% } %> 
          </select>
        
        </div>
        <br>
        <div class="description" >
            <textarea name="description" id="description" cols="30" rows="10" placeholder="Descripción..."></textarea>
        </div>
       <div class="enviar-limpiar">
        <button class=“botonEnviar” type="submit" value="ENVIAR">ENVIAR</button>
        <br>
        <button class=“botonLimpiar” type="reset" value="LIMPIAR">LIMPIAR</button>
        </div>
     

        </div>
        
       </form>
       <div class="imagen1">
        <img src="/images/perchero2.png" alt="imagen1">
    </div>
</div>

<script>
    window.addEventListener('load',()=>{
        /*validacion  nombre del producto*/
        const nameProduct = document.querySelector('#name');
        nameProduct.addEventListener('blur',()=>{
            if(nameProduct.value.length < 5){
                alert("El nombre del producto debe tener al menos 5 caracteres")
                nameProduct.focus();
            }
        });
        /*validacion descripcion del producto*/
        const description = document.querySelector('#description');
        description.addEventListener('blur',()=>{
            if (description.value.length < 20){
                ('la descripcion debe tener al menos 20 caracteres')
            }
        });
       /* const errorImagen = document.querySelector('#errorImagen')
        const imagen = document.querySelector('#image');
        const array = imagen.value.split('.')
        const formatosPermitidos = ['png','jpeg','gif','jpg']
        imagen.addEventListener('load',()=>{
        const formatoValido = false
            for (const formato of formatosPermitidos){
                if(array[1] === formato){
                    formatoValido = true;
                     break;
                }
            }
        if (!formatoValido) {
        errorImagen.innerHTML= 'los formatos permitidos son png, jpeg, gif, jpg';
        }

           
           
        })*/
        

    
    })
    window.addEventListener('storage', (event) => {
        if (event.key === 'imagen') {
        const errorImagen = document.querySelector('#errorImagen');
        const imagen = event.newValue;
        const array = imagen.split('.');
        const formatosPermitidos = ['png', 'jpeg', 'gif', 'jpg'];
        let formatoValido = false;

        for (const formato of formatosPermitidos) {
        if (array[1] === formato) {
        formatoValido = true;
        break;
      }
    }

    if (!formatoValido) {
      errorImagen.innerHTML = 'los formatos permitidos son png, jpeg, gif, jpg';
    }
  }
});
</script>
    <%- include("./partials/footer") %>
